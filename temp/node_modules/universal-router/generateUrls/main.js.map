{"version":3,"file":"main.js","sources":["../src/generateUrls.js"],"sourcesContent":["/**\n * Universal Router (https://www.kriasoft.com/universal-router/)\n *\n * Copyright Â© 2015-present Kriasoft, LLC. All rights reserved.\n *\n * This source code is licensed under the Apache 2.0 license found in the\n * LICENSE.txt file in the root directory of this source tree.\n */\n\n/* eslint no-param-reassign: ['error', { props: false }] */\n\nimport UniversalRouter from './UniversalRouter';\n\nconst { pathToRegexp } = UniversalRouter;\nconst cache = new Map();\n\nfunction cacheRoutes(routesByName, route, routes) {\n  if (routesByName[route.name]) {\n    throw new Error(`Route \"${route.name}\" already exists`);\n  }\n\n  if (route.name) {\n    routesByName[route.name] = route;\n  }\n\n  if (routes) {\n    for (let i = 0; i < routes.length; i += 1) {\n      const childRoute = routes[i];\n      childRoute.parent = route;\n      cacheRoutes(routesByName, childRoute, childRoute.children);\n    }\n  }\n}\n\nfunction generateUrls(router, options = {}) {\n  if (!(router instanceof UniversalRouter)) {\n    throw new TypeError('An instance of UniversalRouter is expected');\n  }\n\n  router.routesByName = router.routesByName || {};\n\n  return (routeName, params) => {\n    let route = router.routesByName[routeName];\n    if (!route) {\n      router.routesByName = {}; // clear cache\n      cacheRoutes(router.routesByName, router.root, router.root.children);\n\n      route = router.routesByName[routeName];\n      if (!route) {\n        throw new Error(`Route \"${routeName}\" not found`);\n      }\n    }\n\n    let regexp = cache.get(route.fullPath);\n    if (!regexp) {\n      let fullPath = '';\n      let rt = route;\n      while (rt) {\n        if (rt.path) {\n          fullPath = rt.path + fullPath;\n        }\n        rt = rt.parent;\n      }\n      const tokens = pathToRegexp.parse(fullPath);\n      const toPath = pathToRegexp.tokensToFunction(tokens);\n      const keys = Object.create(null);\n      for (let i = 0; i < tokens.length; i += 1) {\n        if (typeof tokens[i] !== 'string') {\n          keys[tokens[i].name] = true;\n        }\n      }\n      regexp = { toPath, keys };\n      cache.set(fullPath, regexp);\n      route.fullPath = fullPath;\n    }\n\n    let url = router.baseUrl + regexp.toPath(params, options) || '/';\n\n    if (options.stringifyQueryParams && params) {\n      const queryParams = {};\n      const keys = Object.keys(params);\n      for (let i = 0; i < keys.length; i += 1) {\n        const key = keys[i];\n        if (!regexp.keys[key]) {\n          queryParams[key] = params[key];\n        }\n      }\n      const query = options.stringifyQueryParams(queryParams);\n      if (query) {\n        url += query.charAt(0) === '?' ? query : `?${query}`;\n      }\n    }\n\n    return url;\n  };\n}\n\nUniversalRouter.generateUrls = generateUrls;\n\nexport default generateUrls;\n"],"names":["pathToRegexp","UniversalRouter","cache","Map","cacheRoutes","routesByName","route","routes","name","Error","i","length","childRoute","parent","children","generateUrls","router","options","TypeError","routeName","params","root","regexp","get","fullPath","rt","path","tokens","parse","toPath","tokensToFunction","keys","Object","create","set","url","baseUrl","stringifyQueryParams","queryParams","key","query","charAt"],"mappings":";;;;;;;;AAAA;;;;;;;;;;;AAWA,AAEA,MAAM,EAAEA,YAAF,KAAmBC,eAAzB;AACA,MAAMC,QAAQ,IAAIC,GAAJ,EAAd;;AAEA,SAASC,WAAT,CAAqBC,YAArB,EAAmCC,KAAnC,EAA0CC,MAA1C,EAAkD;MAC5CF,aAAaC,MAAME,IAAnB,CAAJ,EAA8B;UACtB,IAAIC,KAAJ,CAAW,UAASH,MAAME,IAAK,kBAA/B,CAAN;;;MAGEF,MAAME,IAAV,EAAgB;iBACDF,MAAME,IAAnB,IAA2BF,KAA3B;;;MAGEC,MAAJ,EAAY;SACL,IAAIG,IAAI,CAAb,EAAgBA,IAAIH,OAAOI,MAA3B,EAAmCD,KAAK,CAAxC,EAA2C;YACnCE,aAAaL,OAAOG,CAAP,CAAnB;iBACWG,MAAX,GAAoBP,KAApB;kBACYD,YAAZ,EAA0BO,UAA1B,EAAsCA,WAAWE,QAAjD;;;;;AAKN,SAASC,YAAT,CAAsBC,MAAtB,EAA8BC,UAAU,EAAxC,EAA4C;MACtC,EAAED,kBAAkBf,eAApB,CAAJ,EAA0C;UAClC,IAAIiB,SAAJ,CAAc,4CAAd,CAAN;;;SAGKb,YAAP,GAAsBW,OAAOX,YAAP,IAAuB,EAA7C;;SAEO,CAACc,SAAD,EAAYC,MAAZ,KAAuB;QACxBd,QAAQU,OAAOX,YAAP,CAAoBc,SAApB,CAAZ;QACI,CAACb,KAAL,EAAY;aACHD,YAAP,GAAsB,EAAtB,CADU;kBAEEW,OAAOX,YAAnB,EAAiCW,OAAOK,IAAxC,EAA8CL,OAAOK,IAAP,CAAYP,QAA1D;;cAEQE,OAAOX,YAAP,CAAoBc,SAApB,CAAR;UACI,CAACb,KAAL,EAAY;cACJ,IAAIG,KAAJ,CAAW,UAASU,SAAU,aAA9B,CAAN;;;;QAIAG,SAASpB,MAAMqB,GAAN,CAAUjB,MAAMkB,QAAhB,CAAb;QACI,CAACF,MAAL,EAAa;UACPE,WAAW,EAAf;UACIC,KAAKnB,KAAT;aACOmB,EAAP,EAAW;YACLA,GAAGC,IAAP,EAAa;qBACAD,GAAGC,IAAH,GAAUF,QAArB;;aAEGC,GAAGZ,MAAR;;YAEIc,SAAS3B,aAAa4B,KAAb,CAAmBJ,QAAnB,CAAf;YACMK,SAAS7B,aAAa8B,gBAAb,CAA8BH,MAA9B,CAAf;YACMI,OAAOC,OAAOC,MAAP,CAAc,IAAd,CAAb;WACK,IAAIvB,IAAI,CAAb,EAAgBA,IAAIiB,OAAOhB,MAA3B,EAAmCD,KAAK,CAAxC,EAA2C;YACrC,OAAOiB,OAAOjB,CAAP,CAAP,KAAqB,QAAzB,EAAmC;eAC5BiB,OAAOjB,CAAP,EAAUF,IAAf,IAAuB,IAAvB;;;eAGK,EAAEqB,MAAF,EAAUE,IAAV,EAAT;YACMG,GAAN,CAAUV,QAAV,EAAoBF,MAApB;YACME,QAAN,GAAiBA,QAAjB;;;QAGEW,MAAMnB,OAAOoB,OAAP,GAAiBd,OAAOO,MAAP,CAAcT,MAAd,EAAsBH,OAAtB,CAAjB,IAAmD,GAA7D;;QAEIA,QAAQoB,oBAAR,IAAgCjB,MAApC,EAA4C;YACpCkB,cAAc,EAApB;YACMP,OAAOC,OAAOD,IAAP,CAAYX,MAAZ,CAAb;WACK,IAAIV,IAAI,CAAb,EAAgBA,IAAIqB,KAAKpB,MAAzB,EAAiCD,KAAK,CAAtC,EAAyC;cACjC6B,MAAMR,KAAKrB,CAAL,CAAZ;YACI,CAACY,OAAOS,IAAP,CAAYQ,GAAZ,CAAL,EAAuB;sBACTA,GAAZ,IAAmBnB,OAAOmB,GAAP,CAAnB;;;YAGEC,QAAQvB,QAAQoB,oBAAR,CAA6BC,WAA7B,CAAd;UACIE,KAAJ,EAAW;eACFA,MAAMC,MAAN,CAAa,CAAb,MAAoB,GAApB,GAA0BD,KAA1B,GAAmC,IAAGA,KAAM,EAAnD;;;;WAIGL,GAAP;GApDF;;;AAwDFlC,gBAAgBc,YAAhB,GAA+BA,YAA/B;;;;"}